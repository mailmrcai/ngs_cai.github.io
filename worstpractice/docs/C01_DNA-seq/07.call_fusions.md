# Fusions检测和SV检测
融合基因是指两个或者多个基因联合起来，一起转录形成一个转录本。显而易见，要进行fusion检测，最好的就是测RNA，其实就是属于RNA-seq了，但是fusion在项目中往往是和前面的DNA call SNP连在一起的，所有也写在这里。目前常用的融合基因检测的软件有[FusionMap](http://www.arrayserver.com/wiki/index.php?title=FusionMap#Install_FusionMap_on_Linux)、[Soapfuse](https://sourceforge.net/projects/soapfuse/)、[star-fusion](https://github.com/STAR-Fusion/STAR-Fusion/wiki)、[tophat-fusion](https://ccb.jhu.edu/software/tophat/fusion_index.shtml)等。当然，也可以通过bwa比对后提取bam文件中的SA等tag，自编脚本进行分析。biostar上也有一篇[相关软件整理](https://www.biostars.org/p/45986/)，可以参考一下。

就上述四个软件而言，FusionMap的各种结果呈现方式是最好的，但是，这是个商业软件，不太推荐使用。tophat-fusion需要下载极大的blast数据库，同样不推荐。剩下的两个都可以试试，这里就只说star-fusion。

## STAR-Fusion
star-fusion基于perl，clone下来后还需要装一堆perl的包，还有准备比对的基因组，可以参照[wiki](https://github.com/STAR-Fusion/STAR-Fusion/wiki)里的步骤自行建立，也可以直接在[这里](https://data.broadinstitute.org/Trinity/CTAT_RESOURCE_LIB/)下载现成的。

对于双端数据
```bash
 STAR-Fusion --genome_lib_dir /path/to/your/CTAT_resource_lib \
	--left_fq reads_1.fq \
	--right_fq reads_2.fq \
	--output_dir star_fusion_outdir
```

对于单端数据
```bash
 STAR-Fusion --genome_lib_dir /path/to/your/CTAT_resource_lib \
	--left_fq reads_1.fq \ 
	--output_dir star_fusion_outdir
```

## subread-junction
还有这个我使用过的[subread-junction](http://bioinf.wehi.edu.au/subjunc/)，不得不说subread这个软件真的速度奇快。

首先是建立索引
```bash
subread-buildindex -o my_index hg19.fa
```

然后就是检测了
```bash
# 只输出比对到唯一位置的
subjunc -T 5 -i my_index -r reads1.txt -o subjunc_results.bam

# 最多比对到三个位置
subjunc --multiMapping -B 3 -T 5 -i my_index -r reads1.txt -o subjunc_results.bam

# indel设定最大长度16bp
subjunc -I 16 -i my_index -r reads1.txt -o subjunc_results.bam

# 找外显子与外显子融合
subjunc -d 50 -D 600 -i my_index -r reads1.txt -R reads2.txt -o subjunc_results.bam
```

## SV检测
SV检测这里不细说了，主流使用的软件有[breakdancer](https://github.com/genome/breakdancer)、[CREST](https://github.com/youngmook/CREST)、[lumpy](https://github.com/arq5x/lumpy-sv)。各个软件可以到官方文档学习怎么使用。
目前最好的检测方法应该是使用lumpy+cnvnator联合检测。